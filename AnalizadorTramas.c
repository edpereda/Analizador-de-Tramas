#include <stdio.h>
#include <string.h>

unsigned char T[15][125]={
{0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x23,0x8b, 0x46, 0xe9, 0xad, 0x08, 0x06, 0x00, 0x04, 		//trama 1
0x08, 0x00, 0x06, 0x04, 0x00, 0x01, 0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x94, 0xcc, 0x39, 0xcb,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x94, 0xcc, 0x39, 0xfe},

{0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x00, 0x1f,0x45, 0x9d, 0x1e, 0xa2, 0x08, 0x06, 0x00, 0x01, 		//trama 2
0x08, 0x00, 0x06, 0x04, 0x00, 0x02, 0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x94, 0xcc, 0x39, 0xfe,
0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x94, 0xcc, 0x39, 0xcb, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},

{0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x00, 0x23,0x8b, 0x46, 0xe9, 0xad, 0x08, 0x00, 0x46, 0x00, 		//trama 3
0x80, 0x42, 0x04, 0x55, 0x34, 0x11, 0x80, 0x11,0x7e, 0xba, 0x94, 0xcc, 0x39, 0xcb, 0x94, 0xcc, 
0x67, 0x02, 0xaa, 0xbb, 0xcc, 0xdd, 0x04, 0x0c, 0x00, 0x35, 0x00, 0x2e, 0x91, 0x2a, 0xe2, 0x1a, 
0x01, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x77, 0x77, 0x77, 0x03, 0x69, 
0x73, 0x63, 0x05, 0x65, 0x73, 0x63, 0x6f, 0x6d, 0x03, 0x69, 0x70, 0x6e, 0x02, 0x6d, 0x78, 0x00, 
0x00, 0x1c, 0x00, 0x01},
{0x00, 0x02, 0xb3, 0x9c, 0xdf, 0x1b, 0x00, 0x02, 0xb3, 0x9c, 0xae, 0xba, 0x00, 0x04, 0xf0, 0xf1,		//trama 4
0x09, 0x8d, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7c, 0x9b, 0x6d},
{0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x08, 0x06, 0x00, 0x10,		//trama 5
0x08, 0x00, 0x06, 0x04, 0x00, 0x03, 0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x94, 0xcc, 0x39, 0xcb, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x94, 0xcc, 0x3a, 0xe1},
{0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x08, 0x06, 0x00, 0x10,		//trama 6
0x08, 0x00, 0x06, 0x04, 0x00, 0x04, 0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x94, 0xcc, 0x3a, 0xe1,
0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x94, 0xcc, 0x39, 0xcb, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
{0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x08, 0x00, 0x45, 0x00, 		//trama 7
0x00, 0x6f, 0x90, 0x30, 0x40, 0x00, 0xfb, 0x11, 0xd5, 0x9f, 0x94, 0xcc, 0x67, 0x02, 0x94, 0xcc, 
0x39, 0xcb, 0x00, 0x35, 0x04, 0x0c, 0x00, 0x5b, 0x11, 0x84, 0xe2, 0x1a, 0x85, 0x80, 0x00, 0x01, 
0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x03, 0x77, 0x77, 0x77, 0x03, 0x69, 0x73, 0x63, 0x05, 0x65, 
0x73, 0x63, 0x6f, 0x6d, 0x03, 0x69, 0x70, 0x6e, 0x02, 0x6d, 0x78, 0x00, 0x00, 0x1c, 0x00, 0x01, 
0xc0, 0x14, 0x00, 0x06, 0x00, 0x01, 0x00, 0x00, 0x0e, 0x10, 0x00, 0x21, 0x04, 0x64, 0x6e, 0x73, 
0x31, 0xc0, 0x1a, 0x03, 0x74, 0x69, 0x63, 0xc0, 0x1a, 0x77, 0xec, 0xdf, 0x29, 0x00, 0x00, 0x2a, 
0x30, 0x00, 0x00, 0x0e, 0x10, 0x00, 0x12, 0x75, 0x00, 0x00, 0x00, 0x2a, 0x30                  },
{0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x08, 0x00, 0x45, 0x00, 		//trama 8
0x00, 0x42, 0x04, 0x56, 0x00, 0x00, 0x80, 0x11, 0x49, 0x98, 0x94, 0xcc, 0x39, 0xcb, 0x94, 0xcc,
0x67, 0x02, 0x04, 0x0c, 0x00, 0x35, 0x00, 0x2e, 0x11, 0x2a, 0x68, 0x2a, 0x01, 0x00, 0x00, 0x01, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x77, 0x77, 0x77, 0x03, 0x69, 0x73, 0x63, 0x05, 0x65,
0x73, 0x63, 0x6f, 0x6d, 0x03, 0x69, 0x70, 0x6e, 0x02, 0x6d, 0x78, 0x00, 0x00, 0x01, 0x00, 0x01 },
{0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x08, 0x00, 0x45, 0x00, 		//trama 9
0x00, 0x3c, 0x04, 0x57, 0x00, 0x00, 0x80, 0x01, 0x98, 0x25, 0x94, 0xcc, 0x39, 0xcb, 0x94, 0xcc, 
0x3a, 0xe1, 0x08, 0x00, 0x49, 0x5c, 0x03, 0x00, 0x01, 0x00, 0x61, 0x62, 0x63, 0x64, 0x65, 0x66, 
0x67, 0x68, 0x69, 0x6a, 0x6b, 0x6c, 0x6d, 0x6e, 0x6f, 0x70, 0x71, 0x72, 0x73, 0x74, 0x75, 0x76, 
0x77, 0x61, 0x62, 0x63, 0x64, 0x65, 0x66, 0x67, 0x68, 0x69},
{0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x08, 0x00, 0x45, 0x00, 		//trama 10
0x00, 0x3c, 0x01, 0xb5, 0x00, 0x00, 0x3f, 0x01, 0x46, 0xf1, 0x94, 0xcc, 0x3a, 0xe1, 0x94, 0xcc, 
0x39, 0xcb, 0x00, 0x00, 0x51, 0x5c, 0x03, 0x00, 0x01, 0x00, 0x61, 0x62, 0x63, 0x64, 0x65, 0x66, 
0x67, 0x68, 0x69, 0x6a, 0x6b, 0x6c, 0x6d, 0x6e, 0x6f, 0x70, 0x71, 0x72, 0x73, 0x74, 0x75, 0x76, 
0x77, 0x61, 0x62, 0x63, 0x64, 0x65, 0x66, 0x67, 0x68, 0x69},
{0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x00, 0x1c, 0xc0, 0x7b, 0x35, 0xa1, 0x08, 0x00, 0x48, 0x00, 		//trama 11
0x00, 0x48, 0x5c, 0x7d, 0x00, 0x00, 0x80, 0x01, 0x6c, 0x88, 0x94, 0xcc, 0x39, 0xc3, 0x94, 0xcc,
0x00, 0x49, 0x07, 0x0b, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x00,
0x3b, 0x5c, 0x02, 0x00, 0x10, 0x00, 0x61, 0x62, 0x63, 0x64, 0x65, 0x66, 0x67, 0x68, 0x69, 0x6a,
0x6b, 0x6c, 0x6d, 0x6e, 0x6f, 0x70, 0x71, 0x72, 0x73, 0x74, 0x75, 0x76, 0x77, 0x61, 0x62, 0x63, 
0x64, 0x65, 0x66, 0x67, 0x68, 0x69},
{0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x80, 0x35, 0x00, 0x01, 		//trama 12
0x08, 0x00, 0x06, 0x04, 0x00, 0x03, 0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x94, 0xcc, 0x3a, 0xe1, 
0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x94, 0xcc, 0x39, 0xcb, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xd8, 0xee, 0xdf, 0xb0  
},
{0x00, 0x02, 0xb3, 0x9c, 0xae, 0xba, 0x00, 0x02, 0xb3, 0x9c, 0xdf, 0x1b, 0x00, 0x03, 0xf0, 0xf0,		//trama 13
0x7f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x43, 0x05, 0x90, 0x6d},
{0x02, 0xff, 0x53, 0xc3, 0xe9, 0xab, 0x00, 0xff, 0x66, 0x7f, 0xd4, 0x3c, 0x08, 0x00, 0x45, 0x00,		//trama 14
0x00, 0x30, 0x2c, 0x00, 0x40, 0x00, 0x80, 0x06, 0x4b, 0x74, 0xc0, 0xa8, 0x01, 0x02, 0xc0, 0xa8, 
0x01, 0x01, 0x04, 0x03, 0x00, 0x15, 0x00, 0x3b, 0xcf, 0x44, 0x00, 0x00, 0x00, 0x00, 0x50, 0x20, 
0x20, 0x06, 0x43, 0x34, 0x00, 0x00, 0x02, 0x04, 0x05, 0xb4, 0x01, 0x01, 0x04, 0x02},
{0x00, 0xff, 0x66, 0x7f, 0xd4, 0x3c, 0x02, 0xff, 0x53, 0xc3, 0xe9, 0xab, 0x08, 0x00, 0x45, 0x00, 	//trama 15
0x00, 0x30, 0x05, 0xc4, 0x40, 0x00, 0x80, 0x06, 0x71, 0xb0, 0xc0, 0xa8, 0x01, 0x01, 0xc0, 0xa8, 
0x01, 0x02, 0x00, 0x15, 0x04, 0x03, 0x21, 0x5d, 0x3a, 0x44, 0x00, 0x3b, 0xcf, 0x45, 0x70, 0x12,
0x44, 0x02, 0xbb, 0x11, 0x00, 0x00, 0x02, 0x04, 0x05, 0xb4, 0x01, 0x01, 0x04, 0x02},
{0x00, 0x02, 0xb3, 0x9c, 0xae, 0xba, 0x00, 0x02, 0xb3, 0x9c, 0xdf, 0x1b, 0x00, 0x12, 0xf0, 0xf0,		//trama 16
0x0a, 0x0b, 0x0e, 0x00, 0xff, 0xef, 0x14, 0x00, 0x00, 0x00, 0x28, 0x00, 0x00, 0x00, 0x7f, 0x23, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x99, 0x98, 0x6d  
}};

unsigned char TramasLLC[][85]=
	{ 
		{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x03,0xf0,0xf0,
		 0x7f,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x43,0x05,0x90,0x6d}, //trama1
		{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x03,0xf0,0xf1,
		 0x73,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x54,0x90,0x6d}, //trama2
		{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x04,0xf0,0xf0,
		 0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x41,0xa3,0x90,0x6d}, //trama3
		{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
		 0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xf2,0x90,0x6d}, //trama4
		{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x12,0xf0,0xf0,
		 0x00,0x01,0x0e,0x00,0xff,0xef,0x19,0x8f,0xbc,0x05,0x7f,0x00,0x23,0x00,0x7f,0x23,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x41,0x91,0x6d}, //trama5
		{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x12,0xf0,0xf0,
		 0x00,0x03,0x0e,0x00,0xff,0xef,0x17,0x81,0xbc,0x05,0x23,0x00,0x7f,0x00,0x23,0x7f,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x90,0x91,0x6d}, //trama6
		{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
		 0x01,0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xdf,0x91,0x6d}, //trama7
		{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x04,0xf0,0xf1,
		 0x01,0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x18,0xac,0x92,0x6d}, //trama8
		{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0xac,0xf0,0xf0,
		 0x02,0x02,0x0e,0x00,0xff,0xef,0x16,0x04,0x00,0x00,0x00,0x00,0x28,0x00,0x7f,0x23,
		 0xff,0x53,0x4d,0x42,0x72,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x82,0x09,
		 0x00,0x77,0x00,0x02,0x50,0x43,0x20,0x4e,0x45,0x54,0x57,0x4f,0x52,0x4b,0x20,0x50,
		 0x52,0x4f,0x47,0x52,0x41,0x4d,0x20,0x31,0x2e,0x30,0x00,0x02,0x4d,0x49,0x43,0x52,
		 0x4f,0x53,0x4f,0x46,0x54,0x20,0x4e,0x45,0x54,0x57,0x4f,0x52,0x4b,0x53,0x20,0x33,
		 0x2e,0x30,0x00,0x02,0x44,0x4f,0x53,0x20,0x4c,0x4d,0x31,0x2e,0x32,0x58,0x30,0x30,
		 0x32,0x00,0x02,0x44,0x4f,0x53,0x20,0x4c,0x41,0x4e,0x4d,0x41,0x4e,0x32,0x2e,0x31,
		 0x00,0x02,0x57,0x69,0x6e,0x64,0x6f,0x77,0x73,0x20,0x66,0x6f,0x72,0x20,0x57,0x6f,
		 0x72,0x6b,0x67,0x72,0x6f,0x75,0x70,0x73,0x20,0x33,0x2e,0x31,0x61,0x00,0x02,0x4e,
		 0x54,0x20,0x4c,0x4d,0x20,0x30,0x2e,0x31,0x32,0x00,0x00,0xfb,0x92,0x6d,0x86,0xdf}, //trama9
		{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
		 0x01,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7b,0x93,0x6d}, //trama10
		{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x5f,0xf0,0xf0,
		 0x02,0x04,0x0e,0x00,0xff,0xef,0x16,0x0c,0x00,0x00,0x28,0x00,0x28,0x00,0x23,0x7f,
		 0xff,0x53,0x4d,0x42,0x72,0x00,0x00,0x00,0x00,0x80,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x82,0x09,
		 0x11,0x05,0x00,0x02,0x02,0x00,0x01,0x00,0x68,0x0b,0x00,0x00,0x00,0x00,0x01,0x00,
		 0x7f,0x07,0x00,0x80,0x03,0x02,0x00,0x00,0x00,0xe5,0xfe,0x29,0x25,0x7c,0xc2,0x01,
		 0x2c,0x01,0x08,0x08,0x00,0x7f,0x07,0x00,0x80,0x32,0x3e,0xb9,0x3d,0x00,0xca,0x93}, //trama11
		{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x04,0xf0,0xf1,
		 0x01,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7c,0x94,0x6d}, //trama12
		{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x91,0xf0,0xf0,
		 0x04,0x04,0x0e,0x00,0xff,0xef,0x16,0x0c,0x00,0x00,0x28,0x00,0x28,0x00,0x7f,0x23,
		 0xff,0x53,0x4d,0x42,0x73,0x00,0x00,0x00,0x00,0x10,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x82,0x09,
		 0x0d,0x75,0x00,0x5d,0x00,0x68,0x0b,0x02,0x00,0x00,0x00,0x7f,0x07,0x00,0x80,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x20,0x00,0x00,0x00,0x45,
		 0x53,0x43,0x4f,0x4d,0x00,0x57,0x69,0x6e,0x64,0x6f,0x77,0x73,0x20,0x34,0x2e,0x30,
		 0x00,0x57,0x69,0x6e,0x64,0x6f,0x77,0x73,0x20,0x34,0x2e,0x30,0x00,0x04,0xff,0x00,
		 0x00,0x00,0x02,0x00,0x02,0x00,0x17,0x00,0x20,0x00,0x5c,0x5c,0x50,0x52,0x4f,0x47,
		 0x59,0x44,0x45,0x53,0x41,0x5c,0x49,0x50,0x43,0x24,0x00,0x49,0x50,0x43,0x00,0x00}, //trama13
		{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
		 0x01,0x06,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x32,0x95,0x6d}, //trama14
		{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x46,0xf0,0xf0,
		 0x04,0x06,0x0e,0x00,0xff,0xef,0x16,0x0c,0x00,0x00,0x28,0x00,0x28,0x00,0x23,0x7f,
		 0xff,0x53,0x4d,0x42,0x73,0x00,0x00,0x00,0x00,0x90,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0xc0,0x00,0x00,0x00,0x00,0x82,0x09,
		 0x03,0x75,0x00,0x29,0x00,0x00,0x00,0x00,0x00,0x02,0xff,0x00,0x00,0x00,0x04,0x00,
		 0x49,0x50,0x43,0x00,0x00,0x81,0x95,0x6d,0x86,0xcb,0x94,0x6d,0x86,0x0d,0x09,0x0e}, //trama15
		{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x04,0xf0,0xf1,
		 0x01,0x06,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x20,0x96,0x6d}, //trama16
		{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x7e,0xf0,0xf0,
		 0x06,0x06,0x0e,0x00,0xff,0xef,0x16,0x0c,0x00,0x00,0x28,0x00,0x28,0x00,0x7f,0x23,
		 0xff,0x53,0x4d,0x42,0x25,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0xc0,0x00,0x00,0x00,0x00,0x82,0x0a,
		 0x0e,0x20,0x00,0x00,0x00,0x08,0x00,0x00,0x10,0x00,0x00,0x00,0x00,0x88,0x13,0x00,
		 0x00,0x00,0x00,0x20,0x00,0x4c,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x2d,0x00,0x5c,
		 0x50,0x49,0x50,0x45,0x5c,0x4c,0x41,0x4e,0x4d,0x41,0x4e,0x00,0x68,0x00,0x57,0x72,
		 0x4c,0x65,0x68,0x44,0x7a,0x00,0x42,0x31,0x36,0x42,0x42,0x44,0x7a,0x00,0x01,0x00,
		 0x00,0x10,0xff,0xff,0xff,0xff,0x45,0x53,0x43,0x4f,0x4d,0x00,0x00,0x6f,0x96,0x6d}, //trama17
		{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
		 0x01,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xbe,0x96,0x6d}, //trama18
		{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x04,0xf0,0xf1,
		 0x01,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x5d,0x97,0x6d}, //trama19
		{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x7e,0xf0,0xf0,
		 0x08,0x08,0x0e,0x00,0xff,0xef,0x16,0x0c,0x00,0x00,0x28,0x00,0x28,0x00,0x7f,0x23,
		 0xff,0x53,0x4d,0x42,0x25,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0xc0,0x00,0x00,0x00,0x00,0x02,0x0b,
		 0x0e,0x20,0x00,0x00,0x00,0x08,0x00,0x00,0x10,0x00,0x00,0x00,0x00,0x88,0x13,0x00,
		 0x00,0x00,0x00,0x20,0x00,0x4c,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x2d,0x00,0x5c,
		 0x50,0x49,0x50,0x45,0x5c,0x4c,0x41,0x4e,0x4d,0x41,0x4e,0x00,0x68,0x00,0x57,0x72,
		 0x4c,0x65,0x68,0x44,0x7a,0x00,0x42,0x31,0x36,0x42,0x42,0x44,0x7a,0x00,0x01,0x00,
		 0x00,0x10,0x00,0x00,0x00,0x80,0x45,0x53,0x43,0x4f,0x4d,0x00,0x00,0xac,0x97,0x6d}, //trama20
		{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
		 0x01,0x0a,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xfb,0x97,0x6d}, //trama21
		{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x04,0xf0,0xf1,
		 0x01,0x0a,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x4a,0x98,0x6d}, //trama22
		{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x12,0xf0,0xf0,
		 0x0a,0x0b,0x0e,0x00,0xff,0xef,0x14,0x00,0x00,0x00,0x28,0x00,0x00,0x00,0x7f,0x23,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x99,0x98,0x6d}, //trama23
		{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
		 0x01,0x0d,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x45,0x99,0x6d}, //trama24
		{0x03,0x00,0x00,0x00,0x00,0x01,0x00,0x04,0xac,0x44,0x4d,0x02,0x00,0x8b,0xf0,0xf0,
		 0x03,0x2c,0x00,0xff,0xef,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x42,0x34,0x20,
		 0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x1b,0x49,0x42,0x4d,
		 0x53,0x45,0x52,0x56,0x45,0x52,0x20,0x20,0x20,0x20,0x20,0x20,0x00,0xff,0x53,0x4d,
		 0x42,0x25,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x11,0x00,0x00,
		 0x06,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xe8,0x03,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x06,0x00,0x56,0x00,0x03,0x00,0x01,0x00,0x01,0x00,0x02,0x00,
		 0x17,0x00,0x5c,0x4d,0x41,0x49,0x4c,0x53,0x4c,0x4f,0x54,0x5c,0x42,0x52,0x4f,0x57,
		 0x53,0x45,0x00,0x09,0x04,0x33,0x17,0x00,0x00,0x00,0x9b,0x99,0x6d,0x86,0x99,0x98}, //trama25
		{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x35,0xf0,0xf0,
		 0x0c,0x0a,0x0e,0x00,0xff,0xef,0x16,0x04,0x00,0x00,0x00,0x00,0x28,0x00,0x7f,0x23,
		 0xff,0x53,0x4d,0x42,0x71,0x00,0x00,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0xc0,0x00,0x00,0x00,0x00,0x01,0x50,
		 0x00,0x00,0x00,0x45,0xf1,0x99,0x6d,0x86,0x45,0x99,0x6d,0x86,0x1f,0x09,0x52,0x5b}, //trama26
		{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x35,0xf0,0xf0,
		 0x0a,0x0e,0x0e,0x00,0xff,0xef,0x16,0x0c,0x00,0x00,0x28,0x00,0x28,0x00,0x23,0x7f,
		 0xff,0x53,0x4d,0x42,0x71,0x00,0x00,0x00,0x00,0x80,0x01,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0xc0,0x00,0x00,0x00,0x00,0x01,0x50,
		 0x00,0x00,0x00,0x00,0x40,0x9a,0x6d,0x86,0x9b,0x99,0x6d,0x86,0x20,0x09,0x75,0x5b}, //trama27
		{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x12,0xf0,0xf0,
		 0x0e,0x0d,0x0e,0x00,0xff,0xef,0x14,0x00,0x00,0x00,0x28,0x00,0x00,0x00,0x7f,0x23,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x8f,0x9a,0x6d}, //trama28
		{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
		 0x01,0x11,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xde,0x9a,0x6d}, //trama29
		{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x12,0xf0,0xf0,
		 0x10,0x0d,0x0e,0x00,0xff,0xef,0x18,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7f,0x23,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x2d,0x9b,0x6d}, //trama30
		{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
		 0x01,0x13,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7c,0x9b,0x6d}, //trama31
		{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x03,0xf0,0xf0,
		 0x53,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xcb,0x9b,0x6d}, //trama32
		{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x03,0xf0,0xf1,
		 0x73,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x77,0x9c,0x6d},
		 
		{0xff,0xff,0xff,0xff,0xff,0xff,0x00,0x23,0x8b,0x46,0xe9,0xad,0x08,0x06,0x00,0x04, 
		 0x08,0x00,0x06,0x04,0x00,0x01,0x00,0x23,0x8b,0x46,0xe9,0xad,0x94,0xcc,0x39,0xcb, 
		 0x00,0x00,0x00,0x00,0x00,0x00,0x94,0xcc,0x39,0xfe },						   /*Trama a */

		{0x00,0x23,0x8b,0x46,0xe9,0xad,0x00,0x1f,0x45,0x9d,0x1e,0xa2,0x08,0x06,0x00,0x01,  /*TRAMA b */
		 0x08,0x00,0x06,0x04,0x00,0x02,0x00,0x1f,0x45,0x9d,0x1e,0xa2,0x94,0xcc,0x39,0xfe,
		 0x00,0x23,0x8b,0x46,0xe9,0xad,0x94,0xcc,0x39,0xcb,0x00,0x00,0x00,0x00,0x00,0x00,
		 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00 },
		
		{0x00,0x1f,0x45,0x9d,0x1e,0xa2,0x00,0x23,0x8b,0x46,0xe9,0xad,0x08,0x00,0x46,0x00, /* TRAMA c */
		 0x80,0x42,0x04,0x55,0x34,0x11,0x80,0x11,0x6b,0xf0,0x94,0xcc,0x39,0xcb,0x94,0xcc, 
		 0x67,0x02,0xaa,0xbb,0xcc,0xdd,0x04,0x0c,0x00,0x35,0x00,0x2e,0x85,0x7c,0xe2,0x1a,
		 0x01,0x00,0x00,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0x77,0x77,0x77,0x03,0x69,
		 0x73,0x63,0x05,0x65,0x73,0x63,0x6f,0x6d,0x03,0x69,0x70,0x6e,0x02,0x6d,0x78,0x00,
		 0x00,0x1c,0x00,0x01}
	};


char supervision[][5]={"RR","RNR","REJ","SREJ"};
char uc[][30]={"UI","SIM","-","SARM","-","-","-","SABM","DISC","UP","-",
				"SARME","-","-","-","SABME","SNRM","-","-","RSET","-","-","-","XID","-","-","-","SNRME"};
char ur[][30]={"UI","RIM","-","-","-","-","-","-","RD","-","-","-","UA","-",
"-","-","-","FRMR","-","-","-","-","-","XID","-","-","-","DM"};
char msuperv[][5]={"RR","RNR","REJ","SREJ"};
char result[15];

void checksum(unsigned char T[],unsigned char tam, unsigned char protocolo);
int GetData(unsigned char T[]);
unsigned char E=0,entro=0,iniciotcp=0,inicioudp=0;
 
int main(int argc,char**argv){
unsigned char i,repetir,opcion=0;
system("color f1");
printf("\n");
	
	do{
		system ("cls");
		menu();
		scanf("%d",&opcion);
		switch(opcion){
			case 1:
					for(i=0;i<36;i++){
						
						
				        printf("\n============================================================================\n\t\t\t\t\t\t\t\tTRAMA %d\n============================================================================\n",i+1);
				        Analizar ( TramasLLC [i]);
				        if (i==35){
				        	E=0;
							entro=0;
						}
						                                                                          // ############################################
				      /*printf("\t%s0\n",result);
				      strcpy(result," ");*/
				    }
				    printf("\n\n");
				    system ("pause");
				break;
				
			case 2:
					for(i=0;i<16;i++){
						
				        printf("\n============================================================================\n\t\t\t\t\t\t\t\tTRAMA %d\n============================================================================\n",i+1);
				        Analizar ( T[i]);
				        if (i==15){
				        	E=0;
							entro=0;
						}                                                                          // ############################################
				      /*printf("\t%s0\n",result);
				      strcpy(result," ");*/
				    }
				    printf("\n\n");
				    system ("pause");
				break;
				
			default:
					printf("\nOpcion NO VALIDA\n");
					system ("pause");
					system ("cls");
				break;
		}
	}while(repetir!=2);
    
    return 0;
}


int Analizar(unsigned char T[]){

    unsigned short int TamTipo =(T[12]<<8)+T[13];
   

    if(TamTipo<3){
    	printf("\tError: El tamano minimo es 3\n");
	}
	else if(TamTipo<1500){
        printf("\n\tCABECERA: LLC\n");
        switch(T[16]&3){
            case 0:
                if (E)/*ext*/
					printf("T-I,N(s)=%d, N(r)=%d",T[16]>>1,T[17]>>1);
				else
					printf("T-I,n(s)=%d,N(r)=%d",(T[16]>>1)&7,T[16]>>5);
            break;

            case 1:
                if (E)
					printf("T-S %s, N(r)=%d",supervision[(T[16]>>2)&3],T[17]>>1);
				else
					printf("T-S %s, N(r)=%d",supervision[(T[16]>>2)&3]/*Bits SS*/,T[16]>>5);
				
            break;

            case 2:
                printf("\n\tT-I     N(s) = %d, N(r)=%d\n",T[16]>>1,T[17]>>1);
            break;

            case 3:
                if((T[16]>>4)&1){
                    if(T[15]&1)
                        printf("\n\tT-U     %s,  f\n",ur[((T[16]>>2)&3)+(((T[16]>>3)&28))]);
                    else
                    printf("\n\tT-U     %s,  p\n",uc[((T[16]>>2)&3)+(((T[16]>>3)&28))]);
                }
                else
                    printf("\n\tT-U\n");
                    
                if (entro){
                	
				}else{
					/*if ((uc[((T[16]>>2)&3)+((T[16]>>3)&28)]==11)||uc[((T[16]>>2)&3)+((T[16]>>3)&28)]==15||uc[((T[16]>>2)&3)+((T[16]>>3)&28)]==27){*/
					if (((((T[16]>>2)&3)+((T[16]>>3)&28))==11)||(((T[16]>>2)&3)+((T[16]>>3)&28))==15||(((T[16]>>2)&3)+((T[16]>>3)&28))==27){
					E=1;
					printf("\nEXTENDIDA esta activada");
					entro=1;
					}else{
						E=0;
						entro=1;
					}
				}
				
				
            break;
        }
        return 1;
    }
    else if (TamTipo==2054){				//ARP

        printf("\n\n\tCABECERA ARP\n");
        switch((T[14]<<8)+(T[15])){
            case 1:
                printf("\n\tTipo Direccion Hardware:\tEthernet");
            break;
            case 6:
                printf("\n\tTipo Direccion Hardware:\tToken Ring");
            break;
            case 15:
                printf("\n\tTipo Direccion Hardware:\tFrame Reloj");
            break;
            case 16:
                printf("\n\tTipo Direccion Hardware:\tATM");
            break;
            default:
                printf("\n\tTipo Direccion Hardware:\ToTro %c",2);
            break;
        }

        switch((T[16]<<8)+(T[17])){
            case 2048:
                printf("\n\tTipo de Protocolo:\tIP");
            break;

            default:
                printf("\n\tTipo de Protocolo:\tOther%c",2);
            break;
        }
        unsigned char err;

        printf("\n\tOperacion:\t");
        switch((T[20]<<8)+(T[21])){
            case 1:
                printf("Solicitud %c\n",2);
            break;
            case 2:
                printf("Respuesta %c\n",2);
            break;
            case 8:
                printf("Solicitud Inversa %c\n",2);
            break;
            case 9:
                printf("Respuesta Inversa %c\n",2);
            break;
            default:
                printf("Otra %c",2);
            break;
        }

        unsigned char MAC =T[18], PA=T[19];

        unsigned char i=0, aux=22;

            printf("\n\tDireccion Mac Origen:\t\t");
            for(i=0;i<MAC;i++)
                printf("%02x ",T[aux++]);

            printf("\n\tDireccion Ip Origen:\t");
            for(i=0;i<PA;i++){
                printf("%d",T[aux++]);
                if(i<3)
                    printf(".");
            }

            printf("\n\tDireccion Mac Destino:\t\t");
            for(i=0;i<MAC;i++)
                printf("%02x ",T[aux++]);

            printf("\n\tDireccion Ip Destino:\t");
            for(i=0;i<PA;i++){
                printf("%d",T[aux++]);
                if(i<3)
                    printf(".");
            }
            printf("\n");

            return 1;
    }

    else if (TamTipo==2048){                    //CABECERA IP

        unsigned char i;

        printf("\n\n\tCABECERA IP");
        printf("\n\n\tTamTipo Destino:\t");
        for(i=0;i<6;i++)
            printf("%x ",T[i]);
        printf("\n\t Mac Origen:\t");
        for(i;i<12;i++)
            printf("%x ",T[i]);
        printf("\n\t       Tipo:\tProtocolo IP");


        printf("\n\n\tIP");

        printf("\n\n\t    Version:\t%d",(T[14]>>4)&15);                                         // VERSION

        unsigned char ihl=(T[14]&15)*4, var1=ihl+14;
        printf("\n\t\tIHL:\t%d Bytes",ihl);                                                     // IHL

                                                                                                //SERVICIO

        if((T[15]&16)==2)
                printf("\n      Tipo Servicio:\tRetardo");
        if((T[15]&16)==4)
                printf("\n      Tipo Servicio:\tRendimiento");
        if((T[15]&16)==8)
                printf("\n      Tipo Servicio:\tConfiabilidad");
        if((T[15]&16)==16)
                printf("\n      Tipo Servicio:\tCosto");
        if((T[15]&32)>16)
                printf("\n\ttrama dañada");

        printf("\n       Tamaño total:\t%d Bytes",(T[16]<<8)+T[17]);                                 //TAMAÑO

        printf("\n      Identificador:\t%d",(T[18]<<8)+T[19]);                                       //IDENTIFICADOR

        printf("\n\t   Banderas:\t");                                                                //BANDERAS
        if(T[20]&64){
            if(T[20]&32)
                printf("### Error 2");
            printf("Don´t Fragment");
        }else
            printf("Fragment");

        if(T[20]&32)
            printf(" -> More Fragments");
        else
            printf(" -> Last Fragment");

        printf("\n\t     Offset:\t%d Bytes",(((T[20]&31)<<8)+T[21])*8);                             //OFFSET

        printf("\n\t Numero de saltos:\t%d",T[22]);                                                       //SALTOS

        printf("\n\t  Protocolo:\t");
        unsigned char prot;                                                             //PROTOCOLO
        if((T[23]&31)==1)
            printf("ICMP");

        if((T[23]&31)==6)
            printf("TCP");

        if((T[23]&31)==17)
            printf("UDP");

        printf("\n     Checksum Trama:\t%02x %02X",T[24],T[25]);                                    //CHECKSUM :V

        printf("\n\t   Checksum:\t");
        checksum(T,ihl,1);



        printf("\n\t  IP Origen:\t");                                                               //IP ORIGEN
        for(i=26;i<30;i++){
            printf("%d",T[i]);
            if(i<29)
                printf(".");
        }
        printf("\n\t IP Destino:\t");                                                               //IP DESTINO
        for(i;i<34;i++){
            printf("%d",T[i]);
            if(i<33)
                printf(".");
        }

        if(ihl>20){
            printf("\n\t   Opciones:\t");
            for(i;i<ihl+14;i++)
                printf("%02x ",T[i]);
            }
        i=ihl+14;

        switch(T[23]&31){
            case 1:
                printf("\n\n\tPROTOCOLO ICMP\n");
                printf("\n\tNombre de Tipo:\t\t");
                if(T[i]==0){
                    printf("Respuesta Echo");
                    printf("\n\tIdentificador:\t\t%d",(T[i+4]<<8)+T[i+5]);
                    printf("\n\tNumero de Secuencia:\t%d",(T[i+6]<<8)+T[i+7]);
                    i=i+7;
                }

                    //PARA T[i]=8 || T[i]=0 PING Y checksum ***
                if(T[i]==3){
                    printf("Destino Inalcanzable");
                    printf("\n\tCodigo:\t");
                    i=i+1;
                    switch(T[i]){
                        case 0:
                            printf("Red Inalcanzable");
                        break;
                        case 1:
                            printf("Host Inalcanzable");
                        break;
                        case 2:
                            printf("Protocolo Inalcanzable");
                        break;
                        case 3:
                            printf("Puerto Inalcanzable");
                        break;
                        case 4:
                            printf("Fragmentation needed & DF Set");
                        break;
                        case 5:
                            printf("Ruta de Origen Fallida");
                        break;
                        case 6:
                            printf("Red de Destino Desconocida");
                        break;
                        case 7:
                            printf("Host de Destino Descnocido");
                        break;
                        case 8:
                            printf("Host Origen Aislado");
                        break;
                        case 9:
                            printf("Red Administritivamente Prohibida");
                        break;
                        case 10:
                            printf("Host Administritivamente Prohibido");
                        break;
                        case 11:
                            printf("Red Inalcanzable por TOS");
                        break;
                        case 12:
                            printf("Host Inalcanzable por TOS");
                        break;
                        case 13:
                            printf("Comunicacion Administrivamente Prohibida");
                        break;
                        default:
                            printf("\n\tError");
                        break;
                    }
                }
                if(T[i]==4)
                    printf("Source Quench");
                if(T[i]==5)
                    printf("Redirecccionamiento");
                if(T[i]==8){
                    printf("Echo");
                    printf("\n\tIdentificador:\t\t%d",(T[i+4]<<8)+T[i+5]);
                    printf("\n\tNumero de Secuencia:\t%d",(T[i+6]<<8)+T[i+7]);
                    i=i+7;
                }
                    //PARA T[i]=8 || T[i]=0 PING Y checksum ***
                if(T[i]==9)
                    printf("Aviso Router");
                if(T[i]==10)
                    printf("Seleccion de Router");
                if(T[i]==11)
                    printf("Tiempo Expirado");
                if(T[i]==12)
                    printf("Problemas de Parametro");
                if(T[i]==13)
                    printf("Timestamp");
                if(T[i]==14)
                    printf("Timestamp Respuesta");
                if(T[i]==15)
                    printf("Information Solicitud");
                if(T[i]==16)
                    printf("Informacion Respuesta");
                if(T[i]==17)
                    printf("Solicitud de Mascara de Direccion");
                if(T[i]==18)
                    printf("Respuesta de Mascara de Direccion");
                if(T[i]==30)
                    printf("Traceroute");
                    
                //if (T[i]==8 || T[i]==0)
                //printf("\n\tChecksum:\t\t%02x %02x\n",~T[i],~T[i+1]);

                printf("\n\tChecksum:\t\t%02x %02x\n",T[i+2],T[i+3]);

                if(T[i]==0 || T[i]==8){
                    unsigned char *eich=T, moc=0;
                    for(moc;moc<=i;eich++,moc++);
                    printf("\n\tDatos:\t");
                    for(*eich;*eich!='\0';eich++)
                        printf("%c ",*eich);
                }

                printf("\n");


            break;


            case 6:
                printf("\n\n\tPROTOCOLO TCP\n");
            	//printf("Posicion i: %d",i);
            	iniciotcp=i;
                printf("\n\tSource Port:\t\t");
                if (((T[i]<<8)+T[i+1])==7)
                    printf("Echo");
                if (((T[i]<<8)+T[i+1])==22)
                    printf("Ssh");
                if (((T[i]<<8)+T[i+1])==23)
                    printf("Telnet");
                if (((T[i]<<8)+T[i+1])==25)
                    printf("Sntp");
                if (((T[i]<<8)+T[i+1])==80)
                    printf("http");
                if (((T[i]<<8)+T[i+1])==443)
                    printf("https (ssl)");
                else
                    printf("OTRA",(T[i]<<8)+T[i+1]);
                
                i=i+2;
                printf("\n\tPuerto de Destino:\t");
                if (((T[i]<<8)+T[i+1])==7)
                    printf("Echo");
                if (((T[i]<<8)+T[i+1])==22)
                    printf("Ssh");
                if (((T[i]<<8)+T[i+1])==23)
                    printf("Telnet");
                if (((T[i]<<8)+T[i+1])==25)
                    printf("Sntp");
                if (((T[i]<<8)+T[i+1])==80)
                    printf("http");
                if (((T[i]<<8)+T[i+1])==443)
                    printf("https (ssl)");
                else
                    printf("OTRA",(T[i]<<8)+T[i+1]);
                
                i=i+2;
                printf("\n\tNumero de Secuencia:\t%d", (T[i]<<24)+(T[i+1]<<16)+(T[i+2]<<8)+T[i+3]);
                i=i+4;
                printf("\n\tAcknowledgement Number:\t%d", (T[i]<<24)+(T[i+1]<<16)+(T[i+2]<<8)+T[i+3]);
                i=i+4;
                unsigned char ihl2=((T[i]>>4)&15)*4;
                printf("\n\tOffset TCP:\t\t%d Bytes",ihl2);
                printf("\n\tReservado:\t\t4 bits [T(%d)&15]",i);
                i+1;
                printf("\n\tBandera TCP:\t\t");
                if(T[i]&32)
                    printf("-Urgente ");
                if(T[i]&16)
                    printf("-Acknowledge ");
                if(T[i]&8)
                    printf("-Push ");
                if(T[i]&4)
                    printf("-Reset ");
                if (T[i]&2)
                    printf("-Synchronizar ");
                if(T[i]&1)
                    printf("-Terminar");
                i=i+1;
                printf("\n\tVentana:\t\t\t%d",(T[i]<<8)+T[i+1]);
                i=i+2;
                
                printf("\n\tChecksum:\t\t%02x %02x", T[i], T[i+1]);
                //printf("Posicion i: %d",i);
                //------------------------------------------------------
                printf("\n\t\tChecksum calculado:\t\t ");
                checksum(T,i,2);
                //------------------------------------------------------
                
                i=i+2;
                printf("\n\tUrgent Pointer:\t\t%d",(T[i]<<8)+T[i+1]);
                
                i=i+2;
                if(ihl2>20){
                    printf("\n\tOpciones:\t\t");
                    for(i;i<var1+ihl2;i++)
                        printf("%02x ",T[i]);
                }
                printf("\n");
            break;

            case 17:
                printf("\n\n\tPROTOCOLO UDP\n");
                printf("\n\tPuerto de Origen:\t\t");
                inicioudp=i;
                if (((T[i]<<8)+T[i+1])==7)
                    printf("echo");
                if (((T[i]<<8)+T[i+1])==67)
                    printf("bootps (DHCP)");
                if (((T[i]<<8)+T[i+1])==68)
                    printf("bootpc (DHCP)");
                if (((T[i]<<8)+T[i+1])==69)
                    printf("tftp");
                if (((T[i]<<8)+T[i+1])==161)
                    printf("snmp");
                if (((T[i]<<8)+T[i+1])==520)
                    printf("rip");
                else
                    printf("no definida",(T[i]<<8)+T[i+1]);
                
                i=i+2;
                printf("\n\tPuerto de Destino:\t");
                if (((T[i]<<8)+T[i+1])==7)
                    printf("echo");
                if (((T[i]<<8)+T[i+1])==67)
                    printf("bootps (DHCP)");
                if (((T[i]<<8)+T[i+1])==68)
                    printf("bootpc (DHCP)");
                if (((T[i]<<8)+T[i+1])==69)
                    printf("tftp");
                if (((T[i]<<8)+T[i+1])==161)
                    printf("snmp");
                if (((T[i]<<8)+T[i+1])==520)
                    printf("rip");
                else
                    printf("OTRA",(T[i]<<8)+T[i+1]);
                i=i+2;

                unsigned char opcion =(T[i]<<8)+T[i+1];

                printf("\n\tTamano:\t\t\t%d Bytes",opcion);
                i=i+2;
                printf("\n\tChecksum:\t\t%02x %02x\n",T[i],T[i+1]);
                //-----------------------------------------------------
                printf("\n\t\tChecksum calculado:\t");
                checksum(T,i,3);
                //----------------------------------------------------
                i=i+2;
                printf("\n\tDatos:\t");
                for(i;i<=opcion;i++){
                    printf("%c ",T[i]);
                    if(i==53 || i==74)
                        printf("\n\t\t");
                }
                printf("\n");
            break;

            default:
                printf("\n\tOtro %c\n",2);
            break;
        }
        return 1;
    }
    else
        //printf("\t# UNKNOWN #\n");
        printf("\n\tDesconocida\n");
    return 0;

}
void checksum(unsigned char T[],unsigned char ihl, unsigned char protocolo)
{
  short aux=0, i;
  unsigned char par=0,impar=0;

switch(protocolo){
	case 1:   //checksum ip
		for(i=14;i<ihl;i++){
		    if((i%2)==0)
		      aux+=T[i];
	  }
	  impar+=aux>>8;
	  par=aux;
	  aux=0;
	
	  for(i=14;i<ihl;i++){
	    if((i%2)==1)
	      aux+=T[i];
	  }
	
	    par+=aux>>8;
	  impar=impar+aux;
	
	  printf("%02x %02x", par, impar);
		break;
	
	case 2:    //Checksum tcp
	//-------------------------------------------------tcp header
		for(i=iniciotcp;i<ihl;i++){
		    if((i%2)==0)
		      aux+=T[i];
	  }
	  impar+=aux>>8;
	  par=aux;
	  aux=0;
	
	  for(i=iniciotcp;i<ihl;i++){
	    if((i%2)==1)
	      aux+=T[i];
	  }
	
	    par+=aux>>8;
	  impar=impar+aux;
	//----------------------------------------------------tcp pseudoheader
	                                                            //IP ORIGEN
        for(i=26;i<30;i++){
           if((i%2)==0)
		      aux+=T[i];
        }
        impar+=aux>>8;
	  	par=aux;
	  	aux=0;
	  	
        for(i=26;i<30;i++){
           if((i%2)==1)
	      		aux+=T[i];
        }
        
        par+=aux>>8;
	  	impar=impar+aux;
        
                                                                 //IP DESTINO
        for(i=30;i<34;i++){
           if((i%2)==0)
		      aux+=T[i];
        }
        impar+=aux>>8;
	  	par=aux;
	  	aux=0;
	  	
        for(i=30;i<34;i++){
           if((i%2)==1)
	      		aux+=T[i];
        }
        
        par+=aux>>8;
	  	impar=impar+aux;
        
        										//protocole 8 bits
        //T[23]&31
    	
        impar+=aux>>8;
	  	par=aux;
	  	aux=0;
	  	
		aux+=(T[23]&31);
        
        par+=aux>>8;
	  	impar=impar+aux;
        										//total size
        //T[16]<<8)+T[17]
        
        for(i=16;i<18;i++){
           if((i%2)==0)
		      aux+=T[i];
        }
        impar+=aux>>8;
	  	par=aux;
	  	aux=0;
	  	
        for(i=16;i<18;i++){
           if((i%2)==1)
	      		aux+=T[i];
        }
        
        par+=aux>>8;
	  	impar=impar+aux;
        
	  printf("%02x %02x", par, impar);
		break;
		
		case 3:
		//----------------------------------------------udp header
		for(i=inicioudp;i<ihl;i++){
		    if((i%2)==0)
		      aux+=T[i];
	  }
	  impar+=aux>>8;
	  par=aux;
	  aux=0;
	
	  for(i=inicioudp;i<ihl;i++){
	    if((i%2)==1)
	      aux+=T[i];
	  }
	
	    par+=aux>>8;
	  impar=impar+aux;
	//----------------------------------------------------udp pseudoheader
	                                                            //IP ORIGEN
        for(i=26;i<30;i++){
           if((i%2)==0)
		      aux+=T[i];
        }
        impar+=aux>>8;
	  	par=aux;
	  	aux=0;
	  	
        for(i=26;i<30;i++){
           if((i%2)==1)
	      		aux+=T[i];
        }
        
        par+=aux>>8;
	  	impar=impar+aux;
        
                                                                 //IP DESTINO
        for(i=30;i<34;i++){
           if((i%2)==0)
		      aux+=T[i];
        }
        impar+=aux>>8;
	  	par=aux;
	  	aux=0;
	  	
        for(i=30;i<34;i++){
           if((i%2)==1)
	      		aux+=T[i];
        }
        
        par+=aux>>8;
	  	impar=impar+aux;
        
        										//protocole 8 bits
        //T[23]&31
    	
        impar+=aux>>8;
	  	par=aux;
	  	aux=0;
	  	
		aux+=(T[23]&31);
        
        par+=aux>>8;
	  	impar=impar+aux;
        										//total size
        //T[16]<<8)+T[17]
        
        for(i=16;i<18;i++){
           if((i%2)==0)
		      aux+=T[i];
        }
        impar+=aux>>8;
	  	par=aux;
	  	aux=0;
	  	
        for(i=16;i<18;i++){
           if((i%2)==1)
	      		aux+=T[i];
        }
        
        par+=aux>>8;
	  	impar=impar+aux;
	  	
	  	printf("%02x %02x", par, impar);
			break;
		
}
  
}

void menu(){
	printf("\t\t\t\tMENU\n"
		   "\t1. Analizar Tramas LLC\n"
		   "\t2. Analizar Tramas ARP,IP,ICMP,TCP,UDP\n"
		   "Opcion: ");
}
