/*
***Autor: Pereda Guzmán Eduardo Alberto
***Código: Analizador de Tramas
***Materia: Redes de Computadoras
***Escuela: Escuela Superior de Computo (ESCOM).
*/

#include <stdio.h>
#include <string.h>

/*unsigned char T[]={0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x00,0x23,0x8B,0x46,0xE9,0xAD,0x08,0x06,0x00,0x01,
 0x08,0x00,0x06,0x04,0x00,0x01,0x00,0x23,0x8B,0x46,0xE9,0xAD,0x94,0xCC,0x39,0xCB,
 0x00,0x00,0x00,0x00,0x00,0x00,0x94,0xCC,0x39,0xFE};
*/
/*
unsigned char T[ ][32]={
{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x03,0xf0,0xf0,
0x7f,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}, //Trama 1

{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x03,0xf0,0xf1,
0x73,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}, //Trama 2

{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x04,0xf0,0xf0,
0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},//Trama 3

{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}, //Trama 4

{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x12,0xf0,0xf0,
0x00,0x01,0x0e,0x00,0xff,0xef,0x19,0x8f,0xbc,0x05,0x7f,0x00,0x23,0x00,0x7f,0x23}, //Trama 5

{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x12,0xf0,0xf0,
0x00,0x03,0x0e,0x00,0xff,0xef,0x19,0x8f,0xbc,0x05,0x7f,0x00,0x23,0x00,0x7f,0x23}, //Trama 6

{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
0x01,0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}, //Trama 7

{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
0x01,0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}, //Trama 8

{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0xac,0xf0,0xf0,
0x02,0x02,0x0e,0x00,0xff,0xef,0x16,0x04,0x00,0x00,0x00,0x00,0x28,0x00,0x7f,0x23}, //Trama 9

{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
0x01,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}, //Trama 10

{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x5f,0xf0,0xf0,
0x02,0x04,0x0e,0x00,0xff,0xef,0x16,0x0c,0x00,0x00,0x28,0x00,0x28,0x00,0x7f,0x23}, //Trama 11

{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x04,0xf0,0xf1,
0x01,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}, //Trama 12

{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x91,0xf0,0xf0,
0x04,0x04,0x0e,0x00,0xff,0xef,0x16,0x0c,0x00,0x00,0x28,0x00,0x28,0x00,0x7f,0x23}, //Trama 13

{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
0x01,0x06,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}, //Trama 14

{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x46,0xf0,0xf0,
0x04,0x06,0x0e,0x00,0xff,0xef,0x16,0x0c,0x00,0x00,0x28,0x00,0x28,0x00,0x7f,0x23}, //Trama 15

{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x04,0xf0,0xf1,
0x01,0x06,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}, //Trama 16

{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x7e,0xf0,0xf0,
0x06,0x06,0x0e,0x00,0xff,0xef,0x16,0x0c,0x00,0x00,0x28,0x00,0x28,0x00,0x7f,0x23}, //Trama 17

{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
0x01,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}, //Trama 18

{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x04,0xf0,0xf1,
0x01,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}, //Trama 19

{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x7e,0xf0,0xf0,
0x08,0x08,0x0e,0x00,0xff,0xef,0x16,0x0c,0x00,0x00,0x28,0x00,0x28,0x00,0x7f,0x23}, //Trama 20

{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
0x01,0x0a,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}, //Trama 21

{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x04,0xf0,0xf1,
0x01,0x0a,0x0e,0x00,0xff,0xef,0x19,0x8f,0xbc,0x05,0x7f,0x00,0x23,0x00,0x7f,0x23}, //Trama 22

{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x12,0xf0,0xf0,
0x0a,0x0b,0x0e,0x00,0xff,0xef,0x14,0x00,0x00,0x00,0x28,0x00,0x00,0x00,0x7f,0x23}, //Trama 23

{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
0x01,0x0d,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}, //Trama 24

{0x03,0x00,0x00,0x00,0x00,0x01,0x00,0x04,0xac,0x44,0x4d,0x02,0x00,0x8b,0xf0,0xf0,
0x03,0x2c,0x00,0xff,0xef,0x08,0x00,0x00,0x00,0x00,0x00,0x28,0x00,0x42,0x34,0x20}, //Trama 25

{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x35,0xf0,0xf0,
0x0c,0x0a,0x0e,0x00,0xff,0xef,0x16,0x04,0x00,0x00,0x00,0x00,0x28,0x00,0x7f,0x23}, //Trama 26

{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x35,0xf0,0xf0,
0x0a,0x0e,0x00,0x00,0xff,0xef,0x16,0x04,0x00,0x00,0x00,0x00,0x28,0x00,0x7f,0x23}, //Trama 27

{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x12,0xf0,0xf0,
0x0e,0x0d,0x0e,0x00,0xff,0xef,0x14,0x00,0x00,0x00,0x28,0x00,0x00,0x00,0x7f,0x23}, //Trama 28

{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
0x01,0x11,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}, //Trama 29

{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x12,0xf0,0xf0,
0x10,0x0d,0x0e,0x00,0xff,0xef,0x18,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7f,0x23}, //Trama 30

{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x04,0xf0,0xf1,
0x01,0x13,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}, //Trama 31

{0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x03,0xf0,0xf0,
0x53,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}, //Trama 32

{0x00,0x02,0xb3,0x9c,0xdf,0x1b,0x00,0x02,0xb3,0x9c,0xae,0xba,0x00,0x03,0xf0,0xf1,
0x73,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}}; //Trama 33
*/


/*unsigned char T[][125]={
0x13, 0x42, 0x18, 0x63, 0x96, 0x12, 0x13, 0x42, 0x18, 0x96, 0x35, 0x72, 0x08, 0x00, 0x46, 0x00,
0x80, 0x42, 0x04, 0x55, 0x34, 0x11, 0x80, 0x11, 0xbb, 0xf0, 0x94, 0xcc, 0x39, 0xcb, 0x94, 0xcc,
0x67, 0x02, 0xaa, 0xbb, 0xcc, 0xdd, 0x04, 0x0c, 0x00, 0x35, 0x00, 0x2e, 0x85, 0x7c, 0xe2, 0x1a,
0x01, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x77, 0x77, 0x77, 0x03, 0x69,
0x73, 0x63, 0x05, 0x65, 0x73, 0x63, 0x6f, 0xbd, 0x03, 0x69, 0x70, 0x6c, 0x02, 0xbd, 0x78, 0x00,
0x00, 0x1c, 0x00, 0x01};
*/


unsigned char T[15][125]={{
0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x23, /* .......# */
0x8b, 0x46, 0xe9, 0xad, 0x08, 0x06, 0x00, 0x04, /* .F...... */
0x08, 0x00, 0x06, 0x04, 0x00, 0x01, 0x00, 0x23, /* .......# */
0x8b, 0x46, 0xe9, 0xad, 0x94, 0xcc, 0x39, 0xcb, /* .F....9. */
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x94, 0xcc, /* ........ */
0x39, 0xfe                                      /* 9. */
},

{
0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x00, 0x1f, /* .#.F.... */
0x45, 0x9d, 0x1e, 0xa2, 0x08, 0x06, 0x00, 0x01, /* E....... */
0x08, 0x00, 0x06, 0x04, 0x00, 0x02, 0x00, 0x1f, /* ........ */
0x45, 0x9d, 0x1e, 0xa2, 0x94, 0xcc, 0x39, 0xfe, /* E.....9. */
0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x94, 0xcc, /* .#.F.... */
0x39, 0xcb, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, /* 9....... */
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, /* ........ */
0x00, 0x00, 0x00, 0x00                          /* .... */
},
{
0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x00, 0x23, /* ..E....# */
0x8b, 0x46, 0xe9, 0xad, 0x08, 0x00, 0x46, 0x00, /* .F....F. */
0x80, 0x42, 0x04, 0x55, 0x34, 0x11, 0x80, 0x11, /* .B.U4... */
0x6b, 0xf0, 0x94, 0xcc, 0x39, 0xcb, 0x94, 0xcc, /* k...9... */
0x67, 0x02, 0xaa, 0xbb, 0xcc, 0xdd, 0x04, 0x0c, /* g....... */
0x00, 0x35, 0x00, 0x2e, 0x85, 0x7c, 0xe2, 0x1a, /* .5...|.. */
0x01, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, /* ........ */
0x00, 0x00, 0x03, 0x77, 0x77, 0x77, 0x03, 0x69, /* ...www.i */
0x73, 0x63, 0x05, 0x65, 0x73, 0x63, 0x6f, 0x6d, /* sc.escom */
0x03, 0x69, 0x70, 0x6e, 0x02, 0x6d, 0x78, 0x00, /* .ipn.mx. */
0x00, 0x1c, 0x00, 0x01                          /* .... */
},
{
0x00, 0x02, 0xb3, 0x9c, 0xdf, 0x1b, 0x00, 0x02, /* ........ */
0xb3, 0x9c, 0xae, 0xba, 0x00, 0x04, 0xf0, 0xf1, /* ........ */
0x09, 0x8d, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, /* ........ */
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, /* ........ */
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, /* ........ */
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, /* ........ */
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, /* ........ */
0x00, 0x00, 0x00, 0x00, 0x00, 0x7c, 0x9b, 0x6d  /* .....|.m */
},
{
0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x23, /* .......# */
0x8b, 0x46, 0xe9, 0xad, 0x08, 0x06, 0x00, 0x10, /* .F...... */
0x08, 0x00, 0x06, 0x04, 0x00, 0x03, 0x00, 0x23, /* .......# */
0x8b, 0x46, 0xe9, 0xad, 0x94, 0xcc, 0x39, 0xcb, /* .F....9. */
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x94, 0xcc, /* ........ */
0x3a, 0xe1                                      /* :. */
},
{
0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x00, 0x1f, /* .#.F.... */
0x45, 0x9d, 0x1e, 0xa2, 0x08, 0x06, 0x00, 0x10, /* E....... */
0x08, 0x00, 0x06, 0x04, 0x00, 0x04, 0x00, 0x1f, /* ........ */
0x45, 0x9d, 0x1e, 0xa2, 0x94, 0xcc, 0x3a, 0xe1, /* E.....:. */
0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x94, 0xcc, /* .#.F.... */
0x39, 0xcb, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, /* 9....... */
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, /* ........ */
0x00, 0x00, 0x00, 0x00                          /* .... */
},
{
0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x00, 0x1f, /* .#.F.... */
0x45, 0x9d, 0x1e, 0xa2, 0x08, 0x00, 0x45, 0x00, /* E.....E. */
0x00, 0x6f, 0x90, 0x30, 0x40, 0x00, 0xfb, 0x11, /* .o.0@... */
0x24, 0xe7, 0x94, 0xcc, 0x67, 0x02, 0x94, 0xcc, /* $...g... */
0x39, 0xcb, 0x00, 0x35, 0x04, 0x0c, 0x00, 0x5b, /* 9..5...[ */
0xe8, 0x60, 0xe2, 0x1a, 0x85, 0x80, 0x00, 0x01, /* .`...... */
0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x03, 0x77, /* .......w */
0x77, 0x77, 0x03, 0x69, 0x73, 0x63, 0x05, 0x65, /* ww.isc.e */
0x73, 0x63, 0x6f, 0x6d, 0x03, 0x69, 0x70, 0x6e, /* scom.ipn */
0x02, 0x6d, 0x78, 0x00, 0x00, 0x1c, 0x00, 0x01, /* .mx..... */
0xc0, 0x14, 0x00, 0x06, 0x00, 0x01, 0x00, 0x00, /* ........ */
0x0e, 0x10, 0x00, 0x21, 0x04, 0x64, 0x6e, 0x73, /* ...!.dns */
0x31, 0xc0, 0x1a, 0x03, 0x74, 0x69, 0x63, 0xc0, /* 1...tic. */
0x1a, 0x77, 0xec, 0xdf, 0x29, 0x00, 0x00, 0x2a, /* .w..)..* */
0x30, 0x00, 0x00, 0x0e, 0x10, 0x00, 0x12, 0x75, /* 0......u */
0x00, 0x00, 0x00, 0x2a, 0x30                    /* ...*0 */
},
{
0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x00, 0x23, /* ..E....# */
0x8b, 0x46, 0xe9, 0xad, 0x08, 0x00, 0x45, 0x00, /* .F....E. */
0x00, 0x42, 0x04, 0x56, 0x00, 0x00, 0x80, 0x11, /* .B.V.... */
0x6b, 0xef, 0x94, 0xcc, 0x39, 0xcb, 0x94, 0xcc, /* k...9... */
0x67, 0x02, 0x04, 0x0c, 0x00, 0x35, 0x00, 0x2e, /* g....5.. */
0xff, 0x87, 0x68, 0x2a, 0x01, 0x00, 0x00, 0x01, /* ..h*.... */
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x77, /* .......w */
0x77, 0x77, 0x03, 0x69, 0x73, 0x63, 0x05, 0x65, /* ww.isc.e */
0x73, 0x63, 0x6f, 0x6d, 0x03, 0x69, 0x70, 0x6e, /* scom.ipn */
0x02, 0x6d, 0x78, 0x00, 0x00, 0x01, 0x00, 0x01  /* .mx..... */
},
{
0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x00, 0x23, /* ..E....# */
0x8b, 0x46, 0xe9, 0xad, 0x08, 0x00, 0x45, 0x00, /* .F....E. */
0x00, 0x3c, 0x04, 0x57, 0x00, 0x00, 0x80, 0x01, /* .<.W.... */
0x98, 0x25, 0x94, 0xcc, 0x39, 0xcb, 0x94, 0xcc, /* .%..9... */
0x3a, 0xe1, 0x08, 0x00, 0x49, 0x5c, 0x03, 0x00, /* :...I\.. */
0x01, 0x00, 0x61, 0x62, 0x63, 0x64, 0x65, 0x66, /* ..abcdef */
0x67, 0x68, 0x69, 0x6a, 0x6b, 0x6c, 0x6d, 0x6e, /* ghijklmn */
0x6f, 0x70, 0x71, 0x72, 0x73, 0x74, 0x75, 0x76, /* opqrstuv */
0x77, 0x61, 0x62, 0x63, 0x64, 0x65, 0x66, 0x67, /* wabcdefg */
0x68, 0x69                                      /* hi */
},
{
0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x00, 0x1f, /* .#.F.... */
0x45, 0x9d, 0x1e, 0xa2, 0x08, 0x00, 0x45, 0x00, /* E.....E. */
0x00, 0x3c, 0x01, 0xb5, 0x00, 0x00, 0x3f, 0x01, /* .<....?. */
0xdb, 0xc7, 0x94, 0xcc, 0x3a, 0xe1, 0x94, 0xcc, /* ....:... */
0x39, 0xcb, 0x00, 0x00, 0x51, 0x5c, 0x03, 0x00, /* 9...Q\.. */
0x01, 0x00, 0x61, 0x62, 0x63, 0x64, 0x65, 0x66, /* ..abcdef */
0x67, 0x68, 0x69, 0x6a, 0x6b, 0x6c, 0x6d, 0x6e, /* ghijklmn */
0x6f, 0x70, 0x71, 0x72, 0x73, 0x74, 0x75, 0x76, /* opqrstuv */
0x77, 0x61, 0x62, 0x63, 0x64, 0x65, 0x66, 0x67, /* wabcdefg */
0x68, 0x69                                      /* hi */
},
{
0x00, 0x1f, 0x45, 0x9d, 0x1e, 0xa2, 0x00, 0x1c, /* ..E..... */
0xc0, 0x7b, 0x35, 0xa1, 0x08, 0x00, 0x48, 0x00, /* .{5...H. */
0x00, 0x48, 0x5c, 0x7d, 0x00, 0x00, 0x80, 0x01, /* .H\}.... */
0x6c, 0x88, 0x94, 0xcc, 0x39, 0xc3, 0x94, 0xcc, /* l...9... */
0x00, 0x49, 0x07, 0x0b, 0x04, 0x00, 0x00, 0x00, /* .I...... */
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x00, /* ........ */
0x3b, 0x5c, 0x02, 0x00, 0x10, 0x00, 0x61, 0x62, /* ;\....ab */
0x63, 0x64, 0x65, 0x66, 0x67, 0x68, 0x69, 0x6a, /* cdefghij */
0x6b, 0x6c, 0x6d, 0x6e, 0x6f, 0x70, 0x71, 0x72, /* klmnopqr */
0x73, 0x74, 0x75, 0x76, 0x77, 0x61, 0x62, 0x63, /* stuvwabc */
0x64, 0x65, 0x66, 0x67, 0x68, 0x69              /* defghi */
},
{
0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x00, 0x1f, /* .#.F.... */
0x45, 0x9d, 0x1e, 0xa2, 0x80, 0x35, 0x00, 0x01, /* E....5.. */
0x08, 0x00, 0x06, 0x04, 0x00, 0x03, 0x00, 0x1f, /* ........ */
0x45, 0x9d, 0x1e, 0xa2, 0x94, 0xcc, 0x3a, 0xe1, /* E.....:. */
0x00, 0x23, 0x8b, 0x46, 0xe9, 0xad, 0x94, 0xcc, /* .#.F.... */
0x39, 0xcb, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, /* 9....... */
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, /* ........ */
0x00, 0x00, 0x00, 0x00, 0xd8, 0xee, 0xdf, 0xb0  /* ........ */
},
{
0x00, 0x02, 0xb3, 0x9c, 0xae, 0xba, 0x00, 0x02, /* ........ */
0xb3, 0x9c, 0xdf, 0x1b, 0x00, 0x03, 0xf0, 0xf0, /* ........ */
0x7f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, /* ........ */
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, /* ........ */
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, /* ........ */
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, /* ........ */
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, /* ........ */
0x00, 0x00, 0x00, 0x00, 0x43, 0x05, 0x90, 0x6d  /* ....C..m */
},
{
0x02, 0xff, 0x53, 0xc3, 0xe9, 0xab, 0x00, 0xff, /* ..S..... */
0x66, 0x7f, 0xd4, 0x3c, 0x08, 0x00, 0x45, 0x00, /* f..<..E. */
0x00, 0x30, 0x2c, 0x00, 0x40, 0x00, 0x80, 0x06, /* .0,.@... */
0x4b, 0x74, 0xc0, 0xa8, 0x01, 0x02, 0xc0, 0xa8, /* Kt...... */
0x01, 0x01, 0x04, 0x03, 0x00, 0x15, 0x00, 0x3b, /* .......; */
0xcf, 0x44, 0x00, 0x00, 0x00, 0x00, 0x50, 0x20, /* .D....p  */
0x20, 0x00, 0x0c, 0x34, 0x00, 0x00, 0x02, 0x04, /*  ..4.... */
0x05, 0xb4, 0x01, 0x01, 0x04, 0x02              /* ...... */
},
{
0x00, 0xff, 0x66, 0x7f, 0xd4, 0x3c, 0x02, 0xff, /* ..f..<.. */
0x53, 0xc3, 0xe9, 0xab, 0x08, 0x00, 0x45, 0x00, /* S.....E. */
0x00, 0x30, 0x05, 0xc4, 0x40, 0x00, 0x80, 0x06, /* .0..@... */
0x71, 0xb0, 0xc0, 0xa8, 0x01, 0x01, 0xc0, 0xa8, /* q....... */
0x01, 0x02, 0x00, 0x15, 0x04, 0x03, 0x21, 0x5d, /* ......!] */
0x3a, 0x44, 0x00, 0x3b, 0xcf, 0x45, 0x70, 0x12, /* :D.;.Ep. */
0x44, 0x70, 0x8c, 0x11, 0x00, 0x00, 0x02, 0x04, /* Dp...... */
0x05, 0xb4, 0x01, 0x01, 0x04, 0x02              /* ...... */
},
{
0x00, 0x02, 0xb3, 0x9c, 0xae, 0xba, 0x00, 0x02, /* ........ */
0xb3, 0x9c, 0xdf, 0x1b, 0x00, 0x12, 0xf0, 0xf0, /* ........ */
0x0a, 0x0b, 0x0e, 0x00, 0xff, 0xef, 0x14, 0x00, /* ........ */
0x00, 0x00, 0x28, 0x00, 0x00, 0x00, 0x7f, 0x23, /* ..(....# */
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, /* ........ */
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, /* ........ */
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, /* ........ */
0x00, 0x00, 0x00, 0x00, 0x01, 0x99, 0x98, 0x6d  /* .......m */
}};



char supervision[][5]={"RR","RNR","REJ","SREJ"};
char uc[][30]={"UI","RIM","-","SARM","-","-","-","SABM","DISC","UP","-",
"SARME","-","-","-","SABME","SNRM","-","-","RSET","-","-","-","XID","-","-","-","SNRME"};
char ur[][30]={"UI","RIM","-","-","-","-","-","-","RD","-","-","-","UA","-",
"-","-","-","FRMR","-","-","-","-","-","XID","-","-","-","DM"};
char msuperv[][5]={"RR","RNR","REJ","SREJ"};
char result[15];

void checksum(unsigned char T[],unsigned char tam);
int GetData(unsigned char T[]);

int main(int argc,char**argv){
unsigned char i;
printf("\n");

    for(i=0;i<15;i++){
        printf("============================================================================\n\t\t\t\t\t\t\t\tTRAMA %d\n============================================================================",i+1);
        Analizar (T[i]);
                                                                                  // ############################################
      /*printf("\t%s0\n",result);
      strcpy(result," ");
    */
    }
    return 0;
}


int Analizar(unsigned char T[]){

    unsigned short int TamTipo =(T[12]<<8)+T[13];
    unsigned char E=0;

    if(TamTipo<1500){
        printf("\tProtocolo: LLC\n");
        switch(T[16]&3){
            case 0:
                if (E)/*ext*/
					printf("T-I,N(s)=%d, N(r)=%d",T[16]>>1,T[17]>>1);
				else
					printf("T-I,n(s)=%d,N(r)=%d",(T[16]>>1)&7,T[16]>>5);
            break;

            case 1:
                if (E)
					printf("T-S %S, N(r)=%d",supervision[(T[16]>>2)&3],T[17]>>1);
				else
					printf("T-S %S, N(r)=%d",supervision[(T[16]>>2)&3]/*Bits SS*/,T[16]>>5);
            break;

            /*case 2:
                printf("\n\tT-I     N(s) = %d, N(r)=%d\n",T[16]>>1,T[17]>>1);
            break;*/

            case 3:
                if((T[16]>>4)&1){
                    if(T[15]&1)
                        printf("\n\tT-U     %s,  f\n",ur[((T[16]>>2)&3)+(((T[16]>>3)&28))]);
                    else
                    printf("\n\tT-U     %s,  p\n",uc[((T[16]>>2)&3)+(((T[16]>>3)&28))]);
                }
                else
                    printf("\n\tT-U\n");
                    
                if ((uc[((T[16]>>2)&3)+((T[16]>>3)&28)]/*==11*/)||uc[((T[16]>>2)&3)+((T[16]>>3)&28)]/*==15*/||uc[((T[16]>>2)&3)+((T[16]>>3)&28)]/*==27*/)
					E=1;
            break;
        }
        return 1;
    }
    else if (TamTipo==2054){				//ARP

        printf("\n\n\tARP\n");
        switch((T[14]<<8)+(T[15])){
            case 1:
                printf("\n\tHW Type:\tEthernet");
            break;
            case 6:
                printf("\n\tHW Type:\tToken Ring");
            break;
            case 15:
                printf("\n\tHW Type:\tFrame Reloj");
            break;
            case 16:
                printf("\n\tHW Type:\tATM");
            break;
            default:
                printf("\n\tHW Type:\ToTro %c",2);
            break;
        }

        switch((T[16]<<8)+(T[17])){
            case 2048:
                printf("\n\tProtocol Type:\tIP");
            break;

            default:
                printf("\n\t Protocol Type:\tOther%c",2);
            break;
        }
        unsigned char err;

        printf("\n\tOperation:\t");
        switch((T[20]<<8)+(T[21])){
            case 1:
                printf("ARP Request %c\n",2);
            break;
            case 2:
                printf("ARP Reply %c\n",2);
            break;
            case 8:
                printf("Inverse ARP Request %c\n",2);
            break;
            case 9:
                printf("Inverse ARP Reply %c\n",2);
            break;
            default:
                printf("Otra %c",2);
            break;
        }

        unsigned char HW=T[18], PA=T[19];

        unsigned char h=0, aux=22;

            printf("\n\tSource HW Address:\t\t");
            for(h=0;h<HW;h++)
                printf("%02x ",T[aux++]);

            printf("\n\tSource Protocol Address:\t");
            for(h=0;h<PA;h++){
                printf("%d",T[aux++]);
                if(h<3)
                    printf(".");
            }

            printf("\n\tTarjet HW Address:\t\t");
            for(h=0;h<HW;h++)
                printf("%02x ",T[aux++]);

            printf("\n\tTarjet Protocol Address:\t");
            for(h=0;h<PA;h++){
                printf("%d",T[aux++]);
                if(h<3)
                    printf(".");
            }
            printf("\n");

            return 1;
    }

    else if (TamTipo==2048){                    //CABECERA IP

        unsigned char md;

        printf("\n\n\t .:: CABECERA ETHERNET ::.");
        printf("\n\n\tMac Destino:\t");
        for(md=0;md<6;md++)
            printf("%x ",T[md]);
        printf("\n\t Mac Origen:\t");
        for(md;md<12;md++)
            printf("%x ",T[md]);
        printf("\n\t       Tipo:\tProtocolo IP");


        printf("\n\n\t    .:: CABECERA IP ::.");

        printf("\n\n\t    Version:\t%d",(T[14]>>4)&15);                                         // VERSION

        unsigned char ihl=(T[14]&15)*4, var1=ihl+14;
        printf("\n\t\tIHL:\t%d Bytes",ihl);                                                     // IHL

                                                                                                //SERVICIO

        if((T[15]&16)==2)
                printf("\n      Tipo Servicio:\tRetardo");
        if((T[15]&16)==4)
                printf("\n      Tipo Servicio:\tRendimiento");
        if((T[15]&16)==8)
                printf("\n      Tipo Servicio:\tConfiabilidad");
        if((T[15]&16)==16)
                printf("\n      Tipo Servicio:\tCosto");
        if((T[15]&32)>16)
                printf("\n\ttrama dañada");

        printf("\n       Tamaño total:\t%d Bytes",(T[16]<<8)+T[17]);                                 //TAMAÑO

        printf("\n      Identificador:\t%d",(T[18]<<8)+T[19]);                                       //IDENTIFICADOR

        printf("\n\t   Banderas:\t");                                                                //BANDERAS
        if(T[20]&64){
            if(T[20]&32)
                printf("### Error 2");
            printf("Don´t Fragment");
        }else
            printf("Fragment");

        if(T[20]&32)
            printf(" -> More Fragments");
        else
            printf(" -> Last Fragment");

        printf("\n\t     Offset:\t%d Bytes",(((T[20]&31)<<8)+T[21])*8);                             //OFFSET

        printf("\n\t No. saltos:\t%d",T[22]);                                                       //SALTOS

        printf("\n\t  Protocolo:\t");
        unsigned char prot;                                                             //PROTOCOLO
        if((T[23]&31)==1)
            printf("ICMP");

        if((T[23]&31)==6)
            printf("TCP");

        if((T[23]&31)==17)
            printf("UDP");

        printf("\n     Checksum Trama:\t%02x %02X",T[24],T[25]);                                    //CHECKSUM :V

        printf("\n\t   Checksum:\t");
        checksum(T,ihl);



        printf("\n\t  IP Origen:\t");                                                               //IP ORIGEN
        for(md=26;md<30;md++){
            printf("%d",T[md]);
            if(md<29)
                printf(".");
        }
        printf("\n\t IP Destino:\t");                                                               //IP DESTINO
        for(md;md<34;md++){
            printf("%d",T[md]);
            if(md<33)
                printf(".");
        }

        if(ihl>20){
            printf("\n\t   Opciones:\t");
            for(md;md<ihl+14;md++)
                printf("%02x ",T[md]);
            }
        md=ihl+14;

        switch(T[23]&31){
            case 1:
                printf("\n\n\t     .:: PROTOCOLO ICMP ::.\n");
                printf("\n\tType Name:\t\t");
                if(T[md]==0){
                    printf("Echo Reply");
                    printf("\n\tIdentifier:\t\t%d",(T[md+4]<<8)+T[md+5]);
                    printf("\n\tSequence Number:\t%d",(T[md+6]<<8)+T[md+7]);
                    md=md+7;
                }

                    //PARA T[md]=8 || T[md]=0 PING Y checksum ***
                if(T[md]==3){
                    printf("Destination Unreachable");
                    printf("\n\tCode:\t");
                    md=md+1;
                    switch(T[md]){
                        case 0:
                            printf("Net Unreachable");
                        break;
                        case 1:
                            printf("Host Unreachable");
                        break;
                        case 2:
                            printf("Protocol Unreachable");
                        break;
                        case 3:
                            printf("Port Unreachable");
                        break;
                        case 4:
                            printf("Fragmentation needed & DF Set");
                        break;
                        case 5:
                            printf("Source Route Failed");
                        break;
                        case 6:
                            printf("Destination Network Unknown");
                        break;
                        case 7:
                            printf("Destination Host Unknown");
                        break;
                        case 8:
                            printf("Source Host Isolated");
                        break;
                        case 9:
                            printf("Network Administratively Prohibited");
                        break;
                        case 10:
                            printf("Host Administratively Prohibited");
                        break;
                        case 11:
                            printf("Network Unreachable for TOS");
                        break;
                        case 12:
                            printf("Host Unreachable for TOS");
                        break;
                        case 13:
                            printf("Comunication Administratively Prohibited");
                        break;
                        default:
                            printf("\n\tError 3 :(");
                        break;
                    }
                }
                if(T[md]==4)
                    printf("Source Quench");
                if(T[md]==5)
                    printf("Redirect");
                if(T[md]==8){
                    printf("Echo");
                    printf("\n\tIdentifier:\t\t%d",(T[md+4]<<8)+T[md+5]);
                    printf("\n\tSequence Number:\t%d",(T[md+6]<<8)+T[md+7]);
                    md=md+7;
                }
                    //PARA T[md]=8 || T[md]=0 PING Y checksum ***
                if(T[md]==9)
                    printf("Router Advertisement");
                if(T[md]==10)
                    printf("Router Selection");
                if(T[md]==11)
                    printf("Time Exceeded");
                if(T[md]==12)
                    printf("Parameter Problem");
                if(T[md]==13)
                    printf("Timestamp");
                if(T[md]==14)
                    printf("Timestamp Reply");
                if(T[md]==15)
                    printf("Information Request");
                if(T[md]==16)
                    printf("Information Reply");
                if(T[md]==17)
                    printf("Address Mask Request");
                if(T[md]==18)
                    printf("Address Mask Reply");
                if(T[md]==30)
                    printf("Traceroute");
                //if (T[md]==8 || T[md]==0)
                //printf("\n\tChecksum:\t\t%02x %02x\n",~T[md],~T[md+1]);

                printf("\n\tChecksum:\t\t%02x %02x\n",T[md+2],T[md+3]);

                if(T[md]==0 || T[md]==8){
                    unsigned char *eich=T, moc=0;
                    for(moc;moc<=md;eich++,moc++);
                    printf("\n\tDatos:\t");
                    for(*eich;*eich!='\0';eich++)
                        printf("%c ",*eich);
                }

                printf("\n");

                //RECORDAR PREGUNTAR COMO IMPRIMIR EN EL FOR HASTA EL FINAL DE LA TRAMA PARA SACAR LAS OPCIONES
                //HACER COMPLEMENTO A UNO***

            break;


            case 6:
                printf("\n\n\t     .:: PROTOCOLO TCP ::.\n");
                //PREGUNTAR SI LOS PUERTOS  TIENEN CONTENIDO (HACER IFS) Y FORMATO DE IMPRESION
                printf("\n\tSource Port:\t\t");
                if (((T[md]<<8)+T[md+1])==7)
                    printf("Echo");
                if (((T[md]<<8)+T[md+1])==22)
                    printf("Ssh");
                if (((T[md]<<8)+T[md+1])==23)
                    printf("Telnet");
                if (((T[md]<<8)+T[md+1])==25)
                    printf("Sntp");
                if (((T[md]<<8)+T[md+1])==80)
                    printf("http");
                if (((T[md]<<8)+T[md+1])==443)
                    printf("https (ssl)");
                else
                    printf("OTRA :v",(T[md]<<8)+T[md+1]);
                // hacer opciones 7,22,23,25,80,443***
                md=md+2;
                printf("\n\tDestination Port:\t");
                if (((T[md]<<8)+T[md+1])==7)
                    printf("Echo");
                if (((T[md]<<8)+T[md+1])==22)
                    printf("Ssh");
                if (((T[md]<<8)+T[md+1])==23)
                    printf("Telnet");
                if (((T[md]<<8)+T[md+1])==25)
                    printf("Sntp");
                if (((T[md]<<8)+T[md+1])==80)
                    printf("http");
                if (((T[md]<<8)+T[md+1])==443)
                    printf("https (ssl)");
                else
                    printf("OTRA :v",(T[md]<<8)+T[md+1]);
                // hacer opciones 7,22,23,25,80,443 ***
                md=md+2;
                printf("\n\tSequence Number:\t%d", (T[md]<<24)+(T[md+1]<<16)+(T[md+2]<<8)+T[md+3]);
                md=md+4;
                printf("\n\tAcknowiedgment Number:\t%d", (T[md]<<24)+(T[md+1]<<16)+(T[md+2]<<8)+T[md+3]);
                md=md+4;
                unsigned char ihl2=((T[md]>>4)&15)*4;
                printf("\n\tOffset TCP:\t\t%d Bytes",ihl2);
                printf("\n\tReserved:\t\t4 bits [T(%d)&15]",md);
                md+1;
                printf("\n\tFlag TCP:\t\t");
                if(T[md]&32)
                    printf("-Urgent ");
                if(T[md]&16)
                    printf("-Acknowledge ");
                if(T[md]&8)
                    printf("-Push ");
                if(T[md]&4)
                    printf("-Reset ");
                if (T[md]&2)
                    printf("-Synchronize ");
                if(T[md]&1)
                    printf("-Finish");
                md=md+1;
                printf("\n\tWindow:\t\t\t%d",(T[md]<<8)+T[md+1]);
                md=md+2;
                printf("\n\tChecksum:\t\t%02x %02x", T[md], T[md+1]);
                //AGREGAR CHECKSUM TOMANDO EN CUENTA SI TIENE OPCIONES
                md=md+2;
                printf("\n\tUrgent Pointer:\t\t%d",(T[md]<<8)+T[md+1]);
                //IMPRIMIR ESTE PARAMETRO EN DECIMAL ***
                md=md+2;
                if(ihl2>20){
                    printf("\n\tOpciones:\t\t");
                    for(md;md<var1+ihl2;md++)
                        printf("%02x ",T[md]);
                }
                printf("\n");
            break;

            case 17:
                printf("\n\n\t     .:: PROTOCOLO UDP ::.\n");
                printf("\n\tSource Port:\t\t");
                if (((T[md]<<8)+T[md+1])==7)
                    printf("echo");
                if (((T[md]<<8)+T[md+1])==67)
                    printf("bootps (DHCP)");
                if (((T[md]<<8)+T[md+1])==68)
                    printf("bootpc (DHCP)");
                if (((T[md]<<8)+T[md+1])==69)
                    printf("tftp");
                if (((T[md]<<8)+T[md+1])==161)
                    printf("snmp");
                if (((T[md]<<8)+T[md+1])==520)
                    printf("rip");
                else
                    printf("OTRA :v",(T[md]<<8)+T[md+1]);
                //OPCIONES 7,67,68,69,161,520 ***
                md=md+2;
                printf("\n\tDestination Port:\t");
                if (((T[md]<<8)+T[md+1])==7)
                    printf("echo");
                if (((T[md]<<8)+T[md+1])==67)
                    printf("bootps (DHCP)");
                if (((T[md]<<8)+T[md+1])==68)
                    printf("bootpc (DHCP)");
                if (((T[md]<<8)+T[md+1])==69)
                    printf("tftp");
                if (((T[md]<<8)+T[md+1])==161)
                    printf("snmp");
                if (((T[md]<<8)+T[md+1])==520)
                    printf("rip");
                else
                    printf("OTRA :v",(T[md]<<8)+T[md+1]);
                md=md+2;
                //OPCIONES 7,67,68,69,161,520 ***

                unsigned char opci=(T[md]<<8)+T[md+1];

                printf("\n\tLength:\t\t\t%d Bytes",opci);
                md=md+2;
                printf("\n\tChecksum:\t\t%02x %02x\n",T[md],T[md+1]);
                md=md+2;
                printf("\n\tDatos:\t");
                for(md;md<=opci;md++){
                    printf("%c ",T[md]);
                    if(md==53 || md==74)
                        printf("\n\t\t");
                }
                printf("\n");
            break;

            default:
                printf("\n\tOtro %c\n",2);
            break;
        }
        return 1;
    }
    else
        //printf("\t# UNKNOWN #\n");
        printf("\n");
    return 0;

}
void checksum(unsigned char T[],unsigned char ihl)
{
  short aux=0, i;
  unsigned char par=0,impar=0;

  for(i=14;i<ihl;i++){
    if((i%2)==0)
      aux+=T[i];
  }
  impar+=aux>>8;
  par=aux;
  aux=0;

  for(i=14;i<ihl;i++){
    if((i%2)==1)
      aux+=T[i];
  }

    par+=aux>>8;
  impar=impar+aux;

  printf("%02x %02x", par, impar);
}


